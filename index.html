<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Liaread - Accueil</title>
<link rel="stylesheet" href="style.css">
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-storage-compat.js"></script>
<script src="https://cdn.fedapay.com/fedapay.js"></script>
</head>
<body>
<header>
    <h1>Liaread</h1>
    <nav>
        <a href="signup.html">Créer un compte auteur</a>
        <a href="login.html">Connexion auteur</a>
    </nav>
</header>

<section class="categories">
    <h2>Catégories</h2>
    <button onclick="filterCategory('Tous')">Tous</button>
    <button onclick="filterCategory('Romance')">Romance</button>
    <button onclick="filterCategory('Fantasy')">Fantasy</button>
    <button onclick="filterCategory('Suspense')">Suspense</button>
</section>

<section class="books" id="booksContainer">
    <!-- Les livres seront injectés ici par JS -->
</section>

<footer>
    <p>Contactez-nous : 
        <a href="https://wa.me/2290199616039" target="_blank">WhatsApp</a> | 
        <a href="mailto:agodthanks@gmail.com">Email</a>
    </p>
</footer>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyDpaf3wdXkypPKH443SIZcJRFiz02s-t30",
    authDomain: "liaread.firebaseapp.com",
    projectId: "liaread",
    storageBucket: "liaread.firebasestorage.app",
    messagingSenderId: "951394019167",
    appId: "1:951394019167:web:86825d5ebff4d77807f8ea",
    measurementId: "G-63JN91LVV6"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
const storage = firebase.storage();

// Exemple de livres (à remplacer par Firestore si tu veux)
const books = [
    {id:1, titre:"Aime moi", auteur:"GwenA", prix:2500, categorie:"Romance"},
    {id:2, titre:"Mystère Éternel", auteur:"GwenA", prix:3000, categorie:"Suspense"},
    {id:3, titre:"Fantasy magique", auteur:"GwenA", prix:2800, categorie:"Fantasy"}
];

function displayBooks(filter="Tous"){
    const container = document.getElementById("booksContainer");
    container.innerHTML="";
    books.forEach(book=>{
        if(filter==="Tous" || book.categorie===filter){
            const div = document.createElement("div");
            div.className="book";
            div.innerHTML=`
                <h3>${book.titre}</h3>
                <p>Auteur : ${book.auteur}</p>
                <p>Prix : ${book.prix} FCFA</p>
                <button onclick="payBook(${book.id})">Payer maintenant</button>
            `;
            container.appendChild(div);
        }
    });
}

function filterCategory(cat){
    displayBooks(cat);
}

displayBooks();

function payBook(bookId){
    const book = books.find(b=>b.id===bookId);
    const payment = new FedaPay.Checkout({
        public_key: "pk_live_VTI5GzvTTu2XkwNZybaVi2v4",
        transaction:{
            amount: book.prix,
            currency:"XOF",
            reference:"LIA-"+book.titre.replace(/\s+/g,'-')+"-"+Date.now(),
            customer:{email:"client@example.com"}
        },
        onSuccess: function(tx){
            window.location.href="success.html";
        },
        onError: function(err){
            alert("Le paiement a échoué. Retour à l'accueil.");
            window.location.href="index.html";
        }
    });
    payment.open();
}
</script>
</body>
</html>
